<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>商品详情页</title>
    <link rel="stylesheet" href="../static/css/reset.css">
    <link rel="stylesheet" href="../static/css/fdj/fdj.css">
</head>

<body>
    <div id="header_wrapper">
        <div class="header content">
            <p>您好,欢迎光临凡客诚品！</p>
            <a href="login.html">登录</a>
            <span>|</span>
            <a href="register.html">注册</a>
            <a href="#">我的订单</a>
            <a href="#"><img src="../static/image/common_img/notice.png" />网站公告</a>
            <a href="#"><img src="image/common_img/w1.jpg" />
                <span class="weibomap"></span>
            </a>
            <a href="#"><img src="image/common_img/w2.jpg" /></a>
        </div>
    </div>
    <!-- 头部结束 -->
    <!-- 搜索部分开始 -->
    <div id="search-wrapper">
        <div class="search content">
            <div class="search_top">
                <form action="" method="GET" class="search_box">
                    <input type="text" class="search_input" name="ss" placeholder="搜“日式免烫衬衫”，体验与众不同">
                    <ul class="search_result">
                        <li>人之初，性本善</li>
                    </ul>
                    <input type="submit" value="搜 索" class="search_ss">
                </form>
                <div class="shopping_cart">
                    <div class="shopping_carttop">
                        <a href="#">
                            购物车（<span>0</span>）
                        </a>
                    </div>
                    <div class="shopping_cartbottom">
                        <h2>您的购物车中没有任何商品</h2>

                    </div>
                </div>
            </div>
            <div class="search_bottom">
                <p>
                    <span>热门搜索：</span>
                    <a href="#">免烫衬衫</a>
                    <a href="#">羽绒服</a>
                    <a href="#">外套</a>
                    <a href="#">熊本熊</a>
                    <a href="#">运动户外</a>
                    <a href="#">帆布鞋</a>
                    <a href="#">水柔绵</a>
                </p>
            </div>
        </div>
    </div>
    <!-- 导航开始 -->
    <!-- 导航栏目 -->
    <div id="navBox">
        <a class="navLogo1" href="http://www.vancl.com/"></a>
        <ul id="navList">
            <li><a href="">首页</a></li>
            <li class="navsua1"><a href="">衬衫<em style="display:block;width:25px; height:13px; background:url(http://i3.vanclimg.com/cms/20170329/icon_hot.png) no-repeat scroll; position:absolute;left:485px;top:143px;"></em></a><span></span>
                <div class="navsub1">
                    <ul>
                        <li><a href="">免烫</a></li>
                        <li><a href="">易打理</a></li>
                        <li><a href="">休闲</a></li>
                        <li><a href="">高支</a></li>
                        <li><a href="">法兰绒</a></li>
                        <li><a href="">牛津纺</a></li>
                        <li><a href="">青年布</a></li>
                        <li><a href="">牛仔</a></li>
                        <li><a href="">麻</a></li>
                        <li><a href="">水洗棉</a></li>
                        <li><a href="">泡泡纱</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua2"><a href="">羽绒服</a><span></span>
                <div class="navsub2">
                    <ul>
                        <li><a href="">短款羽绒服</a></li>
                        <li><a href="">长款羽绒服</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua3"><a href="">卫衣</a><span></span>
                <div class="navsub3">
                    <ul>
                        <li><a href="">熊本熊</a></li>
                        <li><a href="">开衫</a></li>
                        <li><a href="">连帽</a></li>
                        <li><a href="">圆领</a></li>
                        <li><a href="">水柔棉</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua4"><a href="">外套</a><span></span>
                <div class="navsub4">
                    <ul>
                        <li><a href="">运动户外</a></li>
                        <li><a href="">皮肤衣</a></li>
                        <li><a href="">西服</a></li>
                        <li><a href="">C9设计款</a></li>
                        <li><a href="">夹克</a></li>
                        <li><a href="">nautilus</a></li>
                        <li><a href="">大衣</a></li>
                        <li><a href="">羽绒服</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua5"><a href="">针织衫</a><span></span>
                <div class="navsub5">
                    <ul>
                        <li><a href="">空调衫</a></li>
                        <li><a href="">棉线衫</a></li>
                        <li><a href="">羊毛衫</a></li>
                        <li><a href="">羊绒衫</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua6"><a href="">裤装</a><span></span>
                <div class="navsub6">
                    <ul>
                        <li><a href="">沙滩裤</a></li>
                        <li><a href="">针织裤</a></li>
                        <li><a href="">休闲裤</a></li>
                        <li><a href="">牛仔裤</a></li>
                        <li><a href="">运动裤</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua7"><a href="">鞋</a><span></span>
                <div class="navsub7">
                    <ul>
                        <li><a href="">复古跑鞋</a></li>
                        <li><a href="">帆布鞋</a></li>
                        <li><a href="">休闲鞋</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua8"><a href="">家具配饰</a><span></span>
                <div class="navsub8">
                    <ul>
                        <li><a href="">床品套件</a></li>
                        <li><a href="">被子</a></li>
                        <li><a href="">枕</a></li>
                        <li><a href="">家居服</a></li>
                        <li><a href="">家居鞋</a></li>
                        <li><a href="">背提包</a></li>
                        <li><a href="">拉杆箱</a></li>
                        <li><a href="">皮带钱包</a></li>
                        <li><a href="">帽子</a></li>
                        <li><a href="">毛巾</a></li>
                    </ul>
                </div>
            </li>
            <li class="navsua9"><a href="">内衣袜品</a><span></span>
                <div class="navsub9">
                    <ul>
                        <li><a href="">船袜</a></li>
                        <li><a href="">中筒袜</a></li>
                        <li><a href="">连裤袜</a></li>
                        <li><a href="">内衣裤</a></li>
                        <li><a href="">围巾披肩</a></li>
                        <li><a href="">童装</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>
    <!-- 商品详情 -->
    <div id="titleShow_wrap">
        <div class="titleShow content">
            <h2>MA1飞行夹克 双面穿 薄棉 C9 军绿色<span>充值购买更优惠</span></h2>
            <ul>
                <li>
                    <a href="#">产品描述</a>|
                </li>
                <li>
                    <a href="#">评论</a>|
                </li>
                <li>
                    <a href="#">提问</a>
                </li>
            </ul>
        </div>
    </div>
    <!-- 放大镜 -->
    <div id="fdj_wrap">
        <div class="fdj content">
            <div class="box">
                <div class="small-box">
                    <ul class="img-box">
                        <li class="active"><img src="../static/image/fdj/01_small.jpg" alt=""></li>
                        <li><img src="../static/image/fdj/02_small.jpg" alt=""></li>
                    </ul>
                </div>
                <div>
                    <div class="show-image">
                        <img src="../static/image/fdj/01_big.jpg" alt="">
                        <span class="filter"></span>
                    </div>
                    <div class="show-big-image">
                        <img src="../static/image/fdj/01_largest.jpg" alt="" id="big-image">
                    </div>
                </div>
            </div>
            <!-- <div class="box_right">
                <div class="top_price">
                    <i>特惠价： ￥</i><span>218.00</span><strong><a href="#">充100返100，点击充值</a></strong>
                </div>
                <div class="getColor">
                    <span>颜色：</span>
                    <ul>
                        <li>
                            <a href="#">
                                <i>
                                </i>军绿色
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i>
                                </i>红色
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i>
                                </i>天蓝色
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="size">
                    <span>尺码：</span>
                    <ul>
                        <li>S</li>
                        <li>M</li>
                        <li>L</li>
                        <li>XL</li>
                        <li>XXL</li>
                    </ul>
                </div>
                <div class="quantity">
                    <span>数量：</span>
                    <select>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>
                <div class="selected">
                    <span>已选：</span>
                </div>
                <div class="urse_buy">
                    <a href="#" class="buy_buy">立即购买</a>
                    <a href="#" class="buy_car"><i><img src="../static/image/fdj/car.jpg" alt=""></i>加入购物车</a>
                </div>
                <div class="Preferential">
                </div>
            </div> -->

            <ul class="shop_carlist">
                    <!-- <li></li> -->
            </ul>
        </div>
    </div>
    <script src="../static/js/searchbox_js/search_jsonp.js"></script>
    <script src="../static/js/searchbox_js/search_box.js"></script>
    <script>
        var insertData = searchInp.insertData.bind(searchInp);   
    </script>

    <script src="../static/js/fdj.js"></script>
    <script src="../static/js/login_js/jquery-3.3.1.js"></script>
    <script src="../static/js/login_js/lunbo.js"></script>
    <script src="js/ajax.js"></script>
    <script>
            var shop = (function() {
                var $ul = document.querySelector('.shop_carlist');
                return {
                    init() {
                        
                        this.event();
                        this.getData();
                    },
                    event() {
                        var _this = this;
                        $ul.onclick = function(e) {
                            e = e || window.event;
                            var target = e.target || e.srcElement;
                            if(target.nodeName === 'BUTTON') {
                                
                                //获取当前的li
                                var father = target.parentNode;
                                //获取商品数量
                                var count = father.querySelector('#count').value;
                                //把数量添加到商品信息中
                                _this.data[father.index].count = Number(count);
                                console.log(_this.data[father.index]);
                                
                                _this.setItem(_this.data[father.index]);
    
                            }
                        }
    
                    },
                    //获取数据
                    getData() {
                        sendAjax('json/shop_car.json').then(res => {
                            res = JSON.parse(res);
                            if(res.code == 0) {
                                //把商品数据存到shop_car对象里
                                this.data = res.data;
                                this.insertData(res.data);
                            }else {
                                alert("获取信息失败，请查询网络状态");
                            }                       
                        });
                    },
                    //渲染数据
                    insertData(data) {
                        
                        
                        console.log(data);
                        //循环数组
                        for(let i = 0;i < data.length; i++){
                            console.log(data);
                            var $li = document.createElement('li');
                            $li.index = i;
                            $li.innerHTML = `
                                <span class='tehui'>特惠价： ￥218.00充100返100，点击充值</span>
                                <li class='color_l'>颜色：<span>红色</span> <span>黄色</span> <span>紫色</span></li>
                                <li class='size'>尺码：<span>S</span> <span>M</span> <span>L</span></li>
                                <span class = 'img'>${data[i].src}</span>
                                <span class = 'title'>${data[i].title}</span>                            
                                数量：<select name="" id="count">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                                已选：<button>立即购买</button>
                                   <button>加入购物车</button>
    
                            `    
                            $ul.appendChild($li);
                        }
                       
                        
                        
                    },
                    //把所选的商品数据存储到本地
                    setItem(data) {
                        //先获取原有数据
                        var shopcarList = localStorage.getItem('shopcarList') || '[]';
                        shopcarList = JSON.parse(shopcarList);
                        //判断购物数据中，是否存在当前商品
                        for(var i = 0; i < shopcarList.length;i++){
                            if(data.id == shopcarList[i].id) {
                                //此商品已经存在
                                shopcarList[i].count += data.count;
                                break;
                            }
    
                        }
                        //循环完就说明商品不存在，然后加进去
                        if(i == shopcarList.length){
                            shopcarList.push(data); 
                        }
                        
                        //再把全部数据存储到本地
                        localStorage.shopcarList = JSON.stringify(shopcarList);
                        console.log(shopcarList);
    
                    }
                }
            }())
            shop.init()
        </script>
</body>

</html>